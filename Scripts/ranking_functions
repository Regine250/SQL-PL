##1. RANKING_FUNCTIONS

SELECT 
    customer_id,
    SUM(amount) AS total_revenue,
    ROW_NUMBER() OVER (ORDER BY SUM(amount) DESC) AS row_num,
    RANK()       OVER (ORDER BY SUM(amount) DESC) AS rank_num,
    DENSE_RANK() OVER (ORDER BY SUM(amount) DESC) AS dense_rank_num,
    PERCENT_RANK() OVER (ORDER BY SUM(amount) DESC) AS percent_rank
FROM transactions
GROUP BY customer_id
ORDER BY total_revenue DESC;

Interpretation:
ROW_NUMBER():  gives each row a unique order.
RANK() and DENSE_RANK():  handle ties differently (RANK skips numbers, DENSE_RANK does not).
PERCENT_RANK():  shows a customerâ€™s relative standing in the group.
